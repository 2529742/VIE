<!DOCTYPE html>  <html> <head>   <title>Util.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="Able.html">                 Able.js               </a>                                           <a class="source" href="Attribute.html">                 Attribute.js               </a>                                           <a class="source" href="Classic.html">                 Classic.js               </a>                                           <a class="source" href="Collection.html">                 Collection.js               </a>                                           <a class="source" href="CollectionView.html">                 CollectionView.js               </a>                                           <a class="source" href="DBPediaService.html">                 DBPediaService.js               </a>                                           <a class="source" href="Entity.html">                 Entity.js               </a>                                           <a class="source" href="EntityView.html">                 EntityView.js               </a>                                           <a class="source" href="Namespace.html">                 Namespace.js               </a>                                           <a class="source" href="RdfaRdfQueryService.html">                 RdfaRdfQueryService.js               </a>                                           <a class="source" href="RdfaService.html">                 RdfaService.js               </a>                                           <a class="source" href="StanbolService.html">                 StanbolService.js               </a>                                           <a class="source" href="Type.html">                 Type.js               </a>                                           <a class="source" href="Util.html">                 Util.js               </a>                                           <a class="source" href="VIE.html">                 VIE.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               Util.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>File:   Util.js <br />
Author: <a href="http://github.com/neogermi/">Sebastian Germesin</a></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Utilities for the day-to-day VIE.js usage</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>extension to jQuery to compare two arrays on equality
found: <a href="http://stackoverflow.com/questions/1773069/using-jquery-to-compare-two-arrays">http://stackoverflow.com/questions/1773069/using-jquery-to-compare-two-arrays</a></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">compare</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="nx">t</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span> <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sort</span><span class="p">(),</span>
        <span class="nx">b</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">sort</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">t</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">b</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span> 
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Extension to the JS native Array implementation to remove values from an array.
from: <a href="http://sebastian.germes.in/blog/2011/09/javascripts-missing-array-remove-function/">http://sebastian.germes.in/blog/2011/09/javascripts-missing-array-remove-function/</a></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">.</span><span class="nx">arguments</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Extension to the JS native Array implementation to remove duplicates from an array.
This actually leaves the original Array untouched and returns a copy with no duplicates.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unduplicate</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unduplicate</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">sorted_arr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sort</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">sorted_arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="nx">sorted_arr</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">sorted_arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">sorted_arr</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
              <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">sorted_arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
          <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">}</span> 


<span class="nx">VIE</span><span class="p">.</span><span class="nx">Util</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>converts a given URI into a CURIE (or save CURIE), based
on the given VIE.Namespaces object.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">toCurie</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">uri</span><span class="p">,</span> <span class="nx">safe</span><span class="p">,</span> <span class="nx">namespaces</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">VIE</span><span class="p">.</span><span class="nx">Util</span><span class="p">.</span><span class="nx">isCurie</span><span class="p">(</span><span class="nx">uri</span><span class="p">,</span> <span class="nx">namespaces</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">uri</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">delim</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">namespaces</span><span class="p">.</span><span class="nx">toObj</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">namespaces</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">k</span><span class="p">))</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">pattern</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;^&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="nx">namespaces</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">k</span><span class="p">));</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">k</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="p">((</span><span class="nx">safe</span><span class="p">)</span><span class="o">?</span> <span class="s2">&quot;[&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> 
                        <span class="nx">uri</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">pattern</span><span class="p">,</span> <span class="nx">k</span> <span class="o">+</span> <span class="nx">delim</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;$/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span>
                        <span class="p">((</span><span class="nx">safe</span><span class="p">)</span><span class="o">?</span> <span class="s2">&quot;]&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;No prefix found for URI &#39;&quot;</span> <span class="o">+</span> <span class="nx">uri</span> <span class="o">+</span> <span class="s2">&quot;&#39;!&quot;</span><span class="p">);</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>checks, whether the given string is a CURIE.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">isCurie</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">something</span><span class="p">,</span> <span class="nx">namespaces</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nx">VIE</span><span class="p">.</span><span class="nx">Util</span><span class="p">.</span><span class="nx">toUri</span><span class="p">(</span><span class="nx">something</span><span class="p">,</span> <span class="nx">namespaces</span><span class="p">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>converts a given CURIE (or save CURIE) into a URI, based
on the given VIE.Namespaces object.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">toUri</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">curie</span><span class="p">,</span> <span class="nx">namespaces</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">delim</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">namespaces</span><span class="p">.</span><span class="nx">toObj</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">k</span> <span class="o">!==</span> <span class="s2">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">curie</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">k</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">curie</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="nx">k</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">pattern</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;^&quot;</span> <span class="o">+</span> <span class="s2">&quot;\\[{0,1}&quot;</span> <span class="o">+</span> <span class="nx">k</span> <span class="o">+</span> <span class="nx">delim</span><span class="p">);</span>
                <span class="k">return</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="nx">curie</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">pattern</span><span class="p">,</span> <span class="nx">namespaces</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">k</span><span class="p">)).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\]{0,1}$/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>default:</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">curie</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">delim</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">namespaces</span><span class="p">.</span><span class="nx">base</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="nx">namespaces</span><span class="p">.</span><span class="nx">base</span><span class="p">()</span> <span class="o">+</span> <span class="nx">curie</span> <span class="o">+</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;No prefix found for CURIE &#39;&quot;</span> <span class="o">+</span> <span class="nx">curie</span> <span class="o">+</span> <span class="s2">&quot;&#39;!&quot;</span><span class="p">);</span>
    <span class="p">},</span>
    </pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>checks, whether the given string is a URI.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">isUri</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">something</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">something</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">something</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="sr">/^&lt;.+:.+&gt;$/</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">},</span>
    
    <span class="nx">_blankNodeSeed</span> <span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">%</span> <span class="mi">1000</span><span class="p">,</span>
    </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>generates a new blank node ID</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">blankNodeID</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_blankNodeSeed</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">return</span> <span class="s1">&#39;_:bnode&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_blankNodeSeed</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
    <span class="p">},</span>
    </pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>this method converts rdf/json data from an external service
into VIE.Entities. (this has been embedded in the StanbolService
but as it is needed in other services, too, it made sense to 
put it into the utils.)</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">rdf2Entities</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">service</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>transform data from Stanbol into VIE.Entities</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">rdf</span> <span class="o">!==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">VIE</span><span class="p">.</span><span class="nx">Util</span><span class="p">.</span><span class="nx">rdf2EntitiesNoRdfQuery</span><span class="p">(</span><span class="nx">service</span><span class="p">,</span> <span class="nx">results</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">rdf</span> <span class="o">=</span> <span class="p">(</span><span class="nx">results</span> <span class="k">instanceof</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">rdf</span><span class="p">)</span><span class="o">?</span> <span class="nx">results</span> <span class="o">:</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">rdf</span><span class="p">().</span><span class="nx">load</span><span class="p">(</span><span class="nx">results</span><span class="p">,</span> <span class="p">{});</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>execute rules here!</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">service</span><span class="p">.</span><span class="nx">rules</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">rules</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">rdf</span><span class="p">.</span><span class="nx">ruleset</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prefix</span> <span class="k">in</span> <span class="nx">service</span><span class="p">.</span><span class="nx">namespaces</span><span class="p">.</span><span class="nx">toObj</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">prefix</span> <span class="o">!==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">rules</span><span class="p">.</span><span class="nx">prefix</span><span class="p">(</span><span class="nx">prefix</span><span class="p">,</span> <span class="nx">service</span><span class="p">.</span><span class="nx">namespaces</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">prefix</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">service</span><span class="p">.</span><span class="nx">rules</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">rules</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">service</span><span class="p">.</span><span class="nx">rules</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="nx">service</span><span class="p">.</span><span class="nx">rules</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="s1">&#39;right&#39;</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="nx">rdf</span> <span class="o">=</span> <span class="nx">rdf</span><span class="p">.</span><span class="nx">reason</span><span class="p">(</span><span class="nx">rules</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="c1">// execute the rules only 10 times to avoid looping</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">rdf</span><span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="s1">&#39;?subject ?property ?object&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">subject</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">subject</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">entities</span><span class="p">[</span><span class="nx">subject</span><span class="p">])</span> <span class="p">{</span>
                <span class="nx">entities</span><span class="p">[</span><span class="nx">subject</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;@subject&#39;</span><span class="o">:</span> <span class="nx">subject</span><span class="p">,</span>
                    <span class="s1">&#39;@context&#39;</span><span class="o">:</span> <span class="nx">service</span><span class="p">.</span><span class="nx">namespaces</span><span class="p">.</span><span class="nx">toObj</span><span class="p">(),</span>
                    <span class="s1">&#39;@type&#39;</span><span class="o">:</span> <span class="p">[]</span>
                <span class="p">};</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">propertyUri</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">property</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">propertyCurie</span><span class="p">;</span>

            <span class="nx">propertyUri</span> <span class="o">=</span> <span class="nx">propertyUri</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">propertyUri</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="nx">property</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">createCurie</span><span class="p">(</span><span class="nx">propertyUri</span><span class="p">,</span> <span class="p">{</span><span class="nx">namespaces</span><span class="o">:</span> <span class="nx">service</span><span class="p">.</span><span class="nx">namespaces</span><span class="p">.</span><span class="nx">toObj</span><span class="p">()});</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">property</span> <span class="o">=</span> <span class="nx">propertyUri</span><span class="p">;</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="nx">propertyUri</span> <span class="o">+</span> <span class="s2">&quot; doesn&#39;t have a namespace definition in &#39;&quot;</span><span class="p">,</span> <span class="nx">service</span><span class="p">.</span><span class="nx">namespaces</span><span class="p">.</span><span class="nx">toObj</span><span class="p">());</span>
            <span class="p">}</span>
            <span class="nx">entities</span><span class="p">[</span><span class="nx">subject</span><span class="p">][</span><span class="nx">property</span><span class="p">]</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">[</span><span class="nx">subject</span><span class="p">][</span><span class="nx">property</span><span class="p">]</span> <span class="o">||</span> <span class="p">[];</span>

            <span class="kd">function</span> <span class="nx">getValue</span><span class="p">(</span><span class="nx">rdfQueryLiteral</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">rdfQueryLiteral</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span><span class="p">){</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">rdfQueryLiteral</span><span class="p">.</span><span class="nx">lang</span><span class="p">)</span>
                        <span class="k">return</span> <span class="nx">rdfQueryLiteral</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
                    <span class="k">else</span>
                        <span class="k">return</span> <span class="nx">rdfQueryLiteral</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                    <span class="k">return</span> <span class="nx">rdfQueryLiteral</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">rdfQueryLiteral</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&quot;uri&quot;</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">rdfQueryLiteral</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">rdfQueryLiteral</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">entities</span><span class="p">[</span><span class="nx">subject</span><span class="p">][</span><span class="nx">property</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">getValue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">object</span><span class="p">));</span>
        <span class="p">});</span>

        <span class="nx">_</span><span class="p">(</span><span class="nx">entities</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">ent</span><span class="p">){</span>
            <span class="nx">ent</span><span class="p">[</span><span class="s2">&quot;@type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">ent</span><span class="p">[</span><span class="s2">&quot;@type&quot;</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">ent</span><span class="p">[</span><span class="s2">&quot;rdf:type&quot;</span><span class="p">]);</span>
            <span class="k">delete</span> <span class="nx">ent</span><span class="p">[</span><span class="s2">&quot;rdf:type&quot;</span><span class="p">];</span>
            <span class="nx">_</span><span class="p">(</span><span class="nx">ent</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">property</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">){</span>
                    <span class="nx">ent</span><span class="p">[</span><span class="nx">property</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">});</span>

        <span class="kd">var</span> <span class="nx">vieEntities</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">entities</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">entityInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">service</span><span class="p">.</span><span class="nx">vie</span><span class="p">.</span><span class="nx">Entity</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="nx">entityInstance</span> <span class="o">=</span> <span class="nx">service</span><span class="p">.</span><span class="nx">vie</span><span class="p">.</span><span class="nx">entities</span><span class="p">.</span><span class="nx">addOrUpdate</span><span class="p">(</span><span class="nx">entityInstance</span><span class="p">);</span>
            <span class="nx">vieEntities</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">entityInstance</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">vieEntities</span><span class="p">;</span>
    <span class="p">},</span>
    </pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>helper if no rdfQuery can be loaded.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">rdf2EntitiesNoRdfQuery</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">service</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">jsonLD</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">_</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">results</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">entity</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="nx">entity</span><span class="p">[</span><span class="s1">&#39;@subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">;</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">triples</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">predicate</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">predicate</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">;</span>
                <span class="nx">_</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">triples</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">triple</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">triple</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;uri&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">triple</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">triple</span><span class="p">.</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">;</span>
                    <span class="p">}</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">entity</span><span class="p">[</span><span class="nx">predicate</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">entity</span><span class="p">[</span><span class="nx">predicate</span><span class="p">]))</span> <span class="p">{</span>
                        <span class="nx">entity</span><span class="p">[</span><span class="nx">predicate</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">entity</span><span class="p">[</span><span class="nx">predicate</span><span class="p">]];</span>
                    <span class="p">}</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">entity</span><span class="p">[</span><span class="nx">predicate</span><span class="p">]))</span> <span class="p">{</span>
                        <span class="nx">entity</span><span class="p">[</span><span class="nx">predicate</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">triple</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
                        <span class="k">return</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="nx">entity</span><span class="p">[</span><span class="nx">predicate</span><span class="p">]</span> <span class="o">=</span> <span class="nx">triple</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                <span class="p">});</span>
            <span class="p">});</span>
            <span class="nx">jsonLD</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">entity</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">jsonLD</span><span class="p">;</span>
    <span class="p">},</span>
    
    <span class="nx">loadSchemaOrg</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">SchemaOrg</span><span class="p">)</span> <span class="p">{</span>
    
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">SchemaOrg</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="s2">&quot;Please load the schema.json file.&quot;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;&lt;http://schema.org/Thing&gt;&quot;</span><span class="p">);</span>
        
        <span class="kd">var</span> <span class="nx">baseNSBefore</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">namespaces</span><span class="p">.</span><span class="nx">base</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">namespaces</span><span class="p">.</span><span class="nx">base</span><span class="p">(</span><span class="s2">&quot;http://schema.org/&quot;</span><span class="p">);</span>
        
        <span class="kd">var</span> <span class="nx">datatypeMapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;DataType&#39;</span><span class="o">:</span> <span class="s1">&#39;xsd:anyType&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Boolean&#39;</span> <span class="o">:</span> <span class="s1">&#39;xsd:boolean&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Date&#39;</span>    <span class="o">:</span> <span class="s1">&#39;xsd:date&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Float&#39;</span>   <span class="o">:</span> <span class="s1">&#39;xsd:float&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Integer&#39;</span> <span class="o">:</span> <span class="s1">&#39;xsd:integer&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Number&#39;</span>  <span class="o">:</span> <span class="s1">&#39;xsd:anySimpleType&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Text&#39;</span>    <span class="o">:</span> <span class="s1">&#39;xsd:string&#39;</span><span class="p">,</span>
            <span class="s1">&#39;URL&#39;</span>     <span class="o">:</span> <span class="s1">&#39;xsd:anyURI&#39;</span>
        <span class="p">};</span>
        
        <span class="kd">var</span> <span class="nx">dataTypeHelper</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ancestors</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="p">[{</span><span class="s1">&#39;id&#39;</span> <span class="o">:</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span> <span class="o">:</span> <span class="nx">datatypeMapping</span><span class="p">[</span><span class="nx">id</span><span class="p">]}]);</span>
            
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ancestors</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">supertype</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">ancestors</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span><span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">ancestors</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">:</span>
                    <span class="nx">dataTypeHelper</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">SchemaOrg</span><span class="p">[</span><span class="s2">&quot;datatypes&quot;</span><span class="p">][</span><span class="nx">ancestors</span><span class="p">[</span><span class="nx">i</span><span class="p">]].</span><span class="nx">supertypes</span><span class="p">,</span> <span class="nx">ancestors</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="nx">type</span><span class="p">.</span><span class="nx">inherit</span><span class="p">(</span><span class="nx">supertype</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">type</span><span class="p">;</span>
        <span class="p">};</span>
        
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">dt</span> <span class="k">in</span> <span class="nx">SchemaOrg</span><span class="p">[</span><span class="s2">&quot;datatypes&quot;</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">dt</span><span class="p">))</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">ancestors</span> <span class="o">=</span> <span class="nx">SchemaOrg</span><span class="p">[</span><span class="s2">&quot;datatypes&quot;</span><span class="p">][</span><span class="nx">dt</span><span class="p">].</span><span class="nx">supertypes</span><span class="p">;</span>
                <span class="nx">dataTypeHelper</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">ancestors</span><span class="p">,</span> <span class="nx">dt</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="kd">var</span> <span class="nx">typeProps</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">props</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="kd">var</span> <span class="nx">specProps</span> <span class="o">=</span> <span class="nx">SchemaOrg</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">][</span><span class="nx">id</span><span class="p">][</span><span class="s2">&quot;specific_properties&quot;</span><span class="p">];</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">p</span> <span class="o">&lt;</span> <span class="nx">specProps</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">p</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">pId</span> <span class="o">=</span> <span class="nx">specProps</span><span class="p">[</span><span class="nx">p</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">range</span> <span class="o">=</span> <span class="nx">SchemaOrg</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="nx">pId</span><span class="p">][</span><span class="s2">&quot;ranges&quot;</span><span class="p">];</span>
                <span class="nx">props</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
                    <span class="s1">&#39;id&#39;</span>    <span class="o">:</span> <span class="nx">pId</span><span class="p">,</span>
                    <span class="s1">&#39;range&#39;</span> <span class="o">:</span> <span class="nx">range</span>
                <span class="p">});</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">props</span><span class="p">;</span>
        <span class="p">};</span>
        
        <span class="kd">var</span> <span class="nx">typeHelper</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ancestors</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">props</span><span class="p">);</span>
           
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ancestors</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">supertype</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">ancestors</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span><span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">ancestors</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">:</span>
                    <span class="nx">typeHelper</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">SchemaOrg</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">][</span><span class="nx">ancestors</span><span class="p">[</span><span class="nx">i</span><span class="p">]].</span><span class="nx">supertypes</span><span class="p">,</span> <span class="nx">ancestors</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">typeProps</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">ancestors</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
                <span class="nx">type</span><span class="p">.</span><span class="nx">inherit</span><span class="p">(</span><span class="nx">supertype</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s2">&quot;Thing&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">type</span><span class="p">.</span><span class="nx">isof</span><span class="p">(</span><span class="s2">&quot;owl:Thing&quot;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">type</span><span class="p">.</span><span class="nx">inherit</span><span class="p">(</span><span class="s2">&quot;owl:Thing&quot;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s2">&quot;BowlingAlley&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="cm">/* debugger */</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">type</span><span class="p">;</span>
        <span class="p">};</span>
        
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">t</span> <span class="k">in</span> <span class="nx">SchemaOrg</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">types</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">t</span><span class="p">))</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">ancestors</span> <span class="o">=</span> <span class="nx">SchemaOrg</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">][</span><span class="nx">t</span><span class="p">].</span><span class="nx">supertypes</span><span class="p">;</span>
                <span class="nx">typeHelper</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">ancestors</span><span class="p">,</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">typeProps</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">t</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">namespaces</span><span class="p">.</span><span class="nx">base</span><span class="p">(</span><span class="nx">baseNSBefore</span><span class="p">);</span>
    
    <span class="p">}</span>
    
<span class="p">};</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 